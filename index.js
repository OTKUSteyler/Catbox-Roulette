(function(s,f,h){"use strict";const r=h.findByProps("sendMessage","editMessage"),l=["png","jpg","jpeg","gif","webp","mp4","webm","mov"],u="abcdefghijklmnopqrstuvwxyz0123456789",m=["https://corsproxy.io/?","https://api.allorigins.win/raw?url="];let c=0;function g(){let a="";for(let t=0;t<6;t++)a+=u.charAt(Math.floor(Math.random()*u.length));const e=l[Math.floor(Math.random()*l.length)];return`https://files.catbox.moe/${a}.${e}`}async function y(a){const e=m[c]+encodeURIComponent(a),t=new AbortController,o=setTimeout(function(){return t.abort()},5e3);try{const n=await fetch(e,{method:"HEAD",signal:t.signal});if(clearTimeout(o),n.ok){const i=n.headers.get("content-type")||"",p=n.headers.get("content-length");if((i.includes("image/")||i.includes("video/")||i.includes("octet-stream"))&&p&&parseInt(p)>1e3)return!0}}catch(n){clearTimeout(o),(n.name==="AbortError"||n.message.includes("fetch"))&&(c=(c+1)%m.length)}return!1}async function w(a=100){for(let e=0;e<a;e++){const t=g();if(await y(t))return{url:t,attempts:e+1};e>0&&e%10===0&&await new Promise(function(o){return setTimeout(o,500)})}return null}let d;var M={onLoad:function(){d=f.registerCommand({name:"catbox",displayName:"Catbox Roulette",description:"Finds and sends a random valid Catbox file",options:[{name:"attempts",displayName:"Max Attempts",description:"Maximum attempts to find a valid file (default: 100)",required:!1,type:4}],execute:async function(a,e){const t=Math.max(10,Math.min(200,a[0]?.value||100));r.sendMessage(e.channel.id,{content:`\u{1F3B2} Searching for a valid Catbox file (max ${t} attempts)...`});const o=Date.now(),n=await w(t),i=((Date.now()-o)/1e3).toFixed(1);n?r.sendMessage(e.channel.id,{content:`\u2705 Found one in ${n.attempts} attempts (${i}s)!
${n.url}`}):r.sendMessage(e.channel.id,{content:`\u274C No valid file found after ${t} attempts (${i}s).

Tip: The odds are very low (~0.05% per try). You might want to try again or increase attempts!`})},applicationId:"-1",inputType:1,type:1})},onUnload:function(){d&&d()}};return s.default=M,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.commands,vendetta.metro);
